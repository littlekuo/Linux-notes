

# 进程调度

## 多任务
分为非抢占式多任务和抢占式多任务

抢占：由调度程序来决定什么时候停止一个程序的运行  
让步：进程主动挂起自己的操作

## Linux的进程调度
2.6.23版本引入了“完全公平调度算法”，叫做CFS

## 策略
### IO消耗型和处理器消耗型
调度策略需要在两个目标间寻找平衡：响应时间短和最大系统利用率

### 进程优先级
最基本的就是基于优先级的调度。  
Linux采用了两种不同的优先级范围：
- nice值，范围从-20 到 +19，默认为0，越大的nice值意味着更低的优先级
- 实时优先级，其值是可以配置的，默认情况下0到99，越高意味着进程优先级越高。
  

### 时间片
时间片：进程被抢占前所能持续运行的时间。  
Linux的CFS调度器并没有直接分配时间片到进程，而是将处理器的使用比划分给了进程。这样一来，进程所获得的处理器时间和负载密切相关。  
Linux中使用的CFS调度器，其抢占时机取决于新的可运行程序消耗了多少处理器使用比，若比当前进程小，则立即投入运行。


## Linux调度算法

### 调度器类
基础的调度器代码定义在 kernel/sched.c文件中，它会按照优先级顺序遍历调度类。
CFS是一个针对普通进程的调度类，在linux中称作SCHED_NORMAL，其实现在kernel/sched_fair.c中。

### Unix系统中的进程调度
Unix系统上，优先级以nice值形式输出给用户空间，但会带来一些问题。
- 若将nice值映射到时间片，则必然需要将nice值对应到处理器的绝对时间。
- 涉及相对nice值时也会带来问题，比如nice值为0和1对应100ms和95ms，而nice值为18和19对应10ms和5ms,这并不合理。
- 执行nice值到时间片的映射，需要能分配一个绝对时间片，这个绝对时间片必须在内核的测试范围内。
- 






